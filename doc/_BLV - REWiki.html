<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app39.us.archive.org';v.server_ms=473;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="/static/js/wbhack.js?v=1522452177.0" charset="utf-8"></script>

<script type="text/javascript">
__wbhack.init('https://web.archive.org/web');
</script>
<link rel="stylesheet" type="text/css" href="/static/css/banner-styles.css?v=1522452177.0" />
<link rel="stylesheet" type="text/css" href="/static/css/iconochive.css?v=1522452177.0" />

<!-- End Wayback Rewrite JS Include -->
<meta charset="UTF-8"/>
<title>.BLV - REWiki</title>
<meta name="generator" content="MediaWiki 1.17.0"/>
<link rel="shortcut icon" href="/web/20160318225010im_/http://rewiki.regengedanken.de/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/web/20160318225010/http://rewiki.regengedanken.de/w/opensearch_desc.php" title="REWiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="http://rewiki.regengedanken.de/w/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="REWiki Atom feed" href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<link rel="stylesheet" href="/web/20160318225010cs_/http://rewiki.regengedanken.de/w/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared&amp;only=styles&amp;skin=monobook&amp;*"/>
<link rel="stylesheet" href="/web/20160318225010cs_/http://rewiki.regengedanken.de/w/skins/monobook/main.css?301" media="screen"/>
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/w/skins/monobook/IE50Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/w/skins/monobook/IE55Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/monobook/IE60Fixes.css?301" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/monobook/IE70Fixes.css?301" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content=""/>
</head>
<body class="mediawiki ltr ns-0 ns-subject page-_BLV skin-monobook"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script type="text/javascript" src="/static/js/timestamp.js?v=1522452177.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/graph-calc.js?v=1522452177.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/auto-complete.js?v=1522452177.0" charset="utf-8"></script>
<script type="text/javascript" src="/static/js/toolbar.js?v=1522452177.0" charset="utf-8"></script>

<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
.wb-autocomplete-suggestions {
    text-align: left; cursor: default; border: 1px solid #ccc; border-top: 0; background: #fff; box-shadow: -1px 1px 3px rgba(0,0,0,.1);
    position: absolute; display: none; z-index: 2147483647; max-height: 254px; overflow: hidden; overflow-y: auto; box-sizing: border-box;
}
.wb-autocomplete-suggestion { position: relative; padding: 0 .6em; line-height: 23px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 1.02em; color: #333; }
.wb-autocomplete-suggestion b { font-weight: bold; }
.wb-autocomplete-suggestion.selected { background: #f0f0f0; }
</style>
<div id="wm-ipp" lang="en" style="display:none;direction:ltr;">
<div style="position:fixed;left:0;top:0;right:0;">
<div id="wm-ipp-inside">
  <div style="position:relative;">
    <div id="wm-logo" style="float:left;width:130px;padding-top:10px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
    </div>
    <div class="r" style="float:right;">
      <div id="wm-btns" style="text-align:right;height:25px;">
                  <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a href="#"
             onclick="__wm.saveSnapshot('http://rewiki.regengedanken.de/wiki/.BLV', '20160318225010')"
             title="Share via My Web Archive"
             id="wm-save-snapshot-open"
          >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php"
             title="Sign In"
             id="wm-sign-in"
          >
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        	<a href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" onclick="__wm.h(event);return false;" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" style="text-align:right;">
	<a href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https://web.archive.org/web/20160318225010/http://rewiki.regengedanken.de/wiki/.BLV', '', 'height=400,width=600'); return false;" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a href="#" onclick="window.open('https://twitter.com/intent/tweet?text=https://web.archive.org/web/20160318225010/http://rewiki.regengedanken.de/wiki/.BLV&amp;via=internetarchive', '', 'height=400,width=600'); return false;" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
    </div>
    <table class="c" style="">
      <tbody>
	<tr>
	  <td class="u" colspan="2">
	    <form target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://rewiki.regengedanken.de/wiki/.BLV" onfocus="this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20160318225010" /><input type="submit" value="Go" /></form>
	  </td>
	  <td class="n" rowspan="2" style="width:110px;">
	    <table>
	      <tbody>
		<!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
		<tr class="m">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20140109022005/http://rewiki.regengedanken.de:80/wiki/.BLV" title="09 Jan 2014"><strong>Jan</strong></a></td>
		  <td class="c" id="displayMonthEl" title="You are here: 22:50:10 Mar 18, 2016">MAR</td>
		  <td class="f" nowrap="nowrap">Apr</td>
		</tr>
		<!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
		<tr class="d">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20140109022005/http://rewiki.regengedanken.de:80/wiki/.BLV" title="02:20:05 Jan 09, 2014"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
		  <td class="c" id="displayDayEl" style="width:34px;font-size:24px;white-space:nowrap;" title="You are here: 22:50:10 Mar 18, 2016">18</td>
		  <td class="f" nowrap="nowrap"><img src="/static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0" /></td>
		</tr>
		<!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
		<tr class="y">
		  <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20140109022005/http://rewiki.regengedanken.de:80/wiki/.BLV" title="09 Jan 2014"><strong>2014</strong></a></td>
		  <td class="c" id="displayYearEl" title="You are here: 22:50:10 Mar 18, 2016">2016</td>
		  <td class="f" nowrap="nowrap">2017</td>
		</tr>
	      </tbody>
	    </table>
	  </td>
	</tr>
	<tr>
	  <td class="s">
	    	    <div id="wm-nav-captures">
	      	      <a class="t" href="/web/20160318225010*/http://rewiki.regengedanken.de/wiki/.BLV" title="See a list of every capture for this URL">4 captures</a>
	      <div class="r" title="Timespan for captures of this URL">19 Jul 2009 - 18 Mar 2016</div>
	      </div>
	  </td>
	  <td class="k">
	    <a href="" id="wm-graph-anchor">
	      <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
		<canvas id="wm-sparkline-canvas" width="575" height="27" border="0"></canvas>
	      </div>
	    </a>
	  </td>
	</tr>
      </tbody>
    </table>
    <div style="position:absolute;bottom:0;right:2px;text-align:right;">
      <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span style="font-size:80%">About this capture</span></a>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
            <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/webwidecrawl" target="_new"><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/hackernews00000)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/hackernews00000" target="_new"><span class="wm-title">Hackernews crawl number 0</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Hacker News Crawl of their links.
	</div>
	      </div>
    </div>
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/static/images/loading.gif" alt="loading" /></div>
    </div>
  </div></div></div></div><script type="text/javascript">
__wm.bt(575,27,25,2,"web","http://rewiki.regengedanken.de/wiki/.BLV","2016-03-18",1996);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	<div id="siteNotice"><div id="localNotice"><p><span style="color:red; font-size:large;">We just moved to a different server. Please be patient until all files and pages are restored and the MediaWiki software has been updated. Thank you</span>
</p></div></div>
	<h1 id="firstHeading" class="firstHeading">.BLV</h1>
	<div id="bodyContent">
		<div id="siteSub">From REWiki</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Games"><span class="tocnumber">1</span> <span class="toctext">Games</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Compression"><span class="tocnumber">2</span> <span class="toctext">Compression</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Structure"><span class="tocnumber">3</span> <span class="toctext">Structure</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Header"><span class="tocnumber">3.1</span> <span class="toctext">Header</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Vertex_data"><span class="tocnumber">3.2</span> <span class="toctext">Vertex data</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Wall_data"><span class="tocnumber">3.3</span> <span class="toctext">Wall data</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Wall_vertex_list"><span class="tocnumber">3.4</span> <span class="toctext">Wall vertex list</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Texture_section"><span class="tocnumber">3.5</span> <span class="toctext">Texture section</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#FaceParams_section"><span class="tocnumber">3.6</span> <span class="toctext">FaceParams section</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Sectors_section"><span class="tocnumber">3.7</span> <span class="toctext">Sectors section</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Object_section"><span class="tocnumber">3.8</span> <span class="toctext">Object section</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#LightSources_section"><span class="tocnumber">3.9</span> <span class="toctext">LightSources section</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Unknown_D_section"><span class="tocnumber">3.10</span> <span class="toctext">Unknown D section</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Spawn_section"><span class="tocnumber">3.11</span> <span class="toctext">Spawn section</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Map_outlines_section"><span class="tocnumber">3.12</span> <span class="toctext">Map outlines section</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#Reference_viewer"><span class="tocnumber">4</span> <span class="toctext">Reference viewer</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Might.26Magic_6-8_Mapviewer"><span class="tocnumber">5</span> <span class="toctext">Might&amp;Magic 6-8 Mapviewer</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Games"> Games </span></h2>
<p><b>.BLV</b> files are used in <a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Might_and_Magic_6" title="Might and Magic 6">Might and Magic 6</a> to store the dungeon level geometry. The format used for <a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=Might_and_Magic_7&amp;action=edit&amp;redlink=1" class="new" title="Might and Magic 7 (page does not exist)">Might and Magic 7</a> is probably similar.
</p>
<h2> <span class="mw-headline" id="Compression"> Compression </span></h2>
<p>To save space, a .BLV file is zlib-compressed using a very simple format (i.e. the file does NOT start with the <a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/MM6_Compressed_Header" title="MM6 Compressed Header">MM6 Compressed Header</a>)
</p>
<pre>
struct CompressedBLV6header
{
  unsigned long compressedSize;
  unsigned long uncompressedSize;
  unsigned char data[];
};
struct CompressedBLV7header
{
  unsigned char id1[4];//0x41 0x67 0x01 0x00
  unsigned char id2[4];//'mvii'
  unsigned long compressedSize;
  unsigned long uncompressedSize;
  unsigned char data[];
};
</pre>
<p>The <code>compressedSize</code> and <code>uncompressedSize</code> fields should be self-explanatory. Simply read <code>compressedSize</code> bytes from the .BLV file (normally that means the entire file, excluding the first 8 bytes(16 bytes for mm7 and mm8)), allocate a buffer of size <code>uncompressedSize</code>, and then call the zlib function <code>uncompress()</code> to decompress the whole file in one go.
</p>
<h2> <span class="mw-headline" id="Structure"> Structure </span></h2>
<p>After decompression, a .BLV file is divided into different sections, each of which is explained below. All sections follow directly after each other, there's (apparently) no offset table or similar structure.
</p>
<h3> <span class="mw-headline" id="Header"> Header </span></h3>
<p>The header is 0x88 bytes long and contains a description and some other (yet unknown) information for the level.
</p>
<pre>
struct Header
{
  uint32 unknown1;         // maybe flags?
  char description[76];    // maybe it's actually smaller and is followed by other data
  char unknown2[24];       // some kind of reference? short-name for the level?
  int32 wall_vertex_size,Rdatasize,RLdatasize;
  int32 unksize2;
  int32 unknown3[4];       
};
</pre>
<h3> <span class="mw-headline" id="Vertex_data"> Vertex data </span></h3>
<p>This section starts at offset 0x88 and contains the vertex data for the level. The first uint32 gives the number of vertices, directly followed by the vertex data as triplets of signed shorts, containing x, y and z-coordinate.
</p>
<pre>
struct VertexSection
{
  uint32 numVertices;

  struct Vertex
  {
    int16 x, y, z;
  } Vertices[];
};
</pre>
<p>The vertices should be numbered from 0 to <code>numVertices-1</code>, as that is how they are referenced later in the wallvertex section
</p>
<h3> <span class="mw-headline" id="Wall_data"> Wall data </span></h3>
<p>This section contains one entry for each wall or portal in the level, which contains a bounding box, the number of vertices for that face, and some unknown fields (probably animation related). Portals used for rendering.
</p>
<pre>

struct WallData
{
  uint32 numWalls;

  struct Wall
  {
#ifndef MM6
    float normal_x,normal_y,normal_z,dist;   // plane by normal vector and dist from (0,0,0) //in mm7 and mm8, dont exist in mm6
#endif
    int32 i_normal_x,i_normal_y,i_normal_z,i_dist;   // plane by normal vector and point, all numbers multiply by 65536, so i_normal_x=int(normal_x*65536.0)
    int32 zcalc1;   // zcalc1 = -(i_normal_x &lt;&lt; 16) / i_normal_z    (or 0 in case i_normal_z == 0)
    int32 zcalc2;   // zcalc2 = -(i_normal_y &lt;&lt; 16) / i_normal_z    (or 0 in case i_normal_z == 0)
    int32 zcalc3;   // zcalc3 = -(i_dist &lt;&lt; 16) / i_normal_z  (or 0 in case i_normal_z == 0)
    int32 bits;   // various attributes, see below
    int32 ingame_pointers[6]; //pointers on wall vertex data, filled by game on load(data in blv file not used)
    int16 face_param_index;       // index in FaceParams array
    int16 unknown3;
    int16 sector_index[2]; //the indices of sectors(sectors section) in which is located the wall
    int16 xmin, xmax;
    int16 ymin, ymax;
    int16 zmin, zmax;
    char orientationType;        // 5 - ceiling, 6 - in-between ceiling and wall, 1 - vertical wall, 4 - in-between floor and wall, 3 - floor
    char numVertices;
    int16 unknown3;       // always zero (alignment?)
  } walls[];
};
</pre>
<p>The <code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code>, <code>zmin</code> and <code>zmax</code> fields contain a bounding box around the wall which was probably needed by the software renderer used in the game. And <code>numVertices</code> contains the number of vertices for this face, which are listed in the next section. Faces should also be counted from 0 to <code>numFaces</code>.
The <code>bits</code> is a combination of values of which the following are known:
</p>
<pre>0x00000001 - It's a portal.
0x00000010 - The texture is wavy, like water.
0x00002000 - Invisible.
0x00040000 - For facets that can be moved (are a part of door or lever). If set, the texture is moved accordingly.
0x00400000 - The texture moves slowly. For horizontal facets only.
0x02000000 - Event can be triggered by clicking on the facet.
0x04000000 - Event can be triggered by stepping on the facet.
0x20000000 - Untouchable You can pass through it.</pre>
<h3> <span class="mw-headline" id="Wall_vertex_list"> Wall vertex list </span></h3>
<p>This section assigns the wall data above to the correct vertices. It follows directly after the previous section, this time without any header or length info at the beginning(length of this section in blv header, field 'wall_vertex_size'), just the raw data. That is possible because all relevant information is already known from the Wall data section.
</p><p>Because walls are polygons, they must be drawn as a closed loop through some number of (coplanar) vertices. The key is the word <b>closed</b> here, which means that for a wall which has <code>n</code> vertices, there are actually <code>n+1</code> vertex indices in this section, where the last index is always the same as the first one.
</p><p>Example: Suppose we have a wall with 12 vertices (as described in it's entry in the wall data section). This means that for this wall, we would have 13 entries here, for example 0x0f, 0x15, 0x01, 0x1a, 0x1a, 0x1c, 0x1c, 0x02, 0x18, 0x11, 0x0d, 0x0b, 0x0f. This is an actual example, taken from the level zddb02.blv (the first wall). I don't know why certain points appear two times in a row, I'm guessing it has something to do with normals or textures (see below for more guesses in that direction&#160;;-). Important thing is that the last vertex is the same as the first one (0x0f).
</p><p>So we have to read <code>n+1</code> vertex indices for each wall. Directly after that, there is more data, which also seems to be repeated <code>n+1</code> times. Here's the structure which describes this, in pseudo-code:
</p>
<pre>
struct WallVertices
{
  uint16 vertex[n+1];  // indexes in Vertices[] from VertexSection,which describe the wall boundary
  int16 x[n+1]; // not sure if this is actually vector (normals?) data.
  int16 y[n+1]; // 
  int16 z[n+1]; //
  int16 x_off[n+1]; //Texture x-offset
  int16 y_off[n+1]; //Texture y-offset
}
</pre>
<h3> <span class="mw-headline" id="Texture_section"> Texture section </span></h3>
<p>This section describes all textures used in the level. Each entry in the wall data section (see above) has one corresponding entry in this list. For each wall data entry, there's a 10-byte ASCIIZ string here describing the texture used by this particular wall. The string gives the filename of a <a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/.TGA" title=".TGA">.TGA</a> file in the BITMAPS<a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/.LOD" title=".LOD">.LOD</a> container file.
</p><p>Portals have emtry string name.
</p>
<h3> <span class="mw-headline" id="FaceParams_section"> FaceParams section </span></h3>
<p>This is another section which contains a counter:
</p>
<pre>
struct FaceParams
{
  uint32 count; // one item size 0x24
  struct FaceParamData
  {
    int16  unk1[6];
    int16  someIndex;  // maybe index into texture list?
    int16  unk2;       // always -1&#160;?
    int16  unk3[2];
    int16 dx,dy;//texture deltas (off 0x14)
    int16 unk4;
    uint16 event_n;// # of event in map evt file
    int16 unk5[4];   // always 0&#160;?
  } FaceParams[];//count items
  struct FaceParam2
  {
    char unknown[10]; //may be name for second texture(usualy filled by zero)
  } FaceParams2[];//count items

};
</pre>
<p>Texture coordinats calculated as:
</p>
<pre>u= (wall_vertex.x_off+faceParam.dx)/texture.Width;
v= (wall_vertex.y_off+faceParam.dy)/texture.Height;
</pre>
<h3> <span class="mw-headline" id="Sectors_section"> Sectors section </span></h3>
<p>BLV map consists of the sectors of those connected by portals. This section consists of 3 parts, Sectors[] array, sectorsRdata, sectorsRLdata, witch follow directly after each other.
</p>
<pre>
struct SectorsSection
{
  uint32 count; 
  struct Sector
  {
#ifdef MM8
    char unk[0x78]; 
#else
    char unk[0x74]; 
#endif
  } Sectors[];
  char sectorsRdata[Header.Rdatasize];
  char sectorsRLdata[Header.RLdatasize];
};
</pre>
<h3> <span class="mw-headline" id="Object_section"> Object section </span></h3>
<p>This section describes the objects found in the dungeon. It starts directly after the Sectors section and has the following format:
</p>
<pre>
struct Object
{
  uint32 numUnknown;
  uint32 numObjects;
  struct Unk
  {
    int16 unk1;
    int16 unk2;
    int16 unk3[12];
#ifdef MM7
    int16 unk4[2];
#endif
#ifdef MM8
    int16 unk4[2];
#endif
  } objectData[numObjects];
  struct Name
  {
    char name[16];
    int16 unk1[4];
    int16 x;
    int16 y;
    int16 z;
    int16 unk2;
  } names[numObjects];
};
</pre>
<h3> <span class="mw-headline" id="LightSources_section"> LightSources section </span></h3>
<p>This section has the following format:
</p>
<pre>
struct LightSources
{
  uint32 count;
  struct light
  {
    int16 x,y,z;
    int16 unk1;//usualy 0
    int16 unk2;//usualy 31
    int16 level;//light brightness
#ifdef MM7
    int16 unk4[2];//color i think
#endif
#ifdef MM8
    int16 unk4[4];//color and something else
#endif
  } lights[n];
};
</pre>
<h3> <span class="mw-headline" id="Unknown_D_section"> Unknown D section </span></h3>
<pre>
struct UnknownD
{
  uint32 count;
  struct Unknown
  {
    uint16 unknown[4];
  } unknown[];
};
</pre>
<h3> <span class="mw-headline" id="Spawn_section"> Spawn section </span></h3>
<p>Information about monsters and may be NPC.
</p>
<pre>
struct Spawn
{
  uint32 count;
  struct SpawnSection
  {
#ifdef MM6
	char unknown[0x14];
#else
	char unknown[0x18];
#endif
    
  } spawns[];
};
</pre>
<h3> <span class="mw-headline" id="Map_outlines_section"> Map outlines section </span></h3>
<p>Information about lines for drawing 2d map in right upper corner.
</p>
<pre>
struct MapOutlines
{
  uint32 count;
  struct outline
  {
    int16 x1,y1,x2,y2,z,unk;
  } outlines[];
};
</pre>
<h2> <span class="mw-headline" id="Reference_viewer"> Reference viewer </span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:182px;"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/File:BLVview.png" class="image"><img alt="" src="/web/20160318225010im_/http://rewiki.regengedanken.de/w/images/thumb/BLVview.png/180px-BLVview.png" width="180" height="143" class="thumbimage"/></a>  <div class="thumbcaption"><div class="magnify"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/File:BLVview.png" class="internal" title="Enlarge"><img src="/web/20160318225010im_/http://rewiki.regengedanken.de/w/skins/common/images/magnify-clip.png" width="15" height="11" alt=""/></a></div>Screenshot of the BLVviewer</div></div></div>
<p>A small windows application, which displays a wireframe model (until I figured out how the textures work) of any .BLV level, can be downloaded <a href="https://web.archive.org/web/20160318225010/http://rewiki.regengedanken.de/files/BLVviewer.zip" class="external text" rel="nofollow">here</a>, the source code will follow soon. To use it, simply give it the name of a BLV level file on the command line.
</p><p>The white lines are the walls, the darker lines are the wall bounding boxes. The center of the image (small 3-colored tripod) can be moved with the cursor keys and PgUp/PgDn, left mouse button rotates the view, mouse wheel zooms and right mouse button adjusts perspective.
</p>
<h2> <span class="mw-headline" id="Might.26Magic_6-8_Mapviewer"> Might&amp;Magic 6-8 Mapviewer </span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:182px;"><a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=Special:Upload&amp;wpDestFile=Mm_mapviewer_dungeon.jpg" class="new" title="File:Mm mapviewer dungeon.jpg">File:Mm mapviewer dungeon.jpg</a>  <div class="thumbcaption">BLV map in Might&amp;Magic 6-8 Mapviewer</div></div></div>
<div class="thumb tright"><div class="thumbinner" style="width:182px;"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/File:Mm_mapviewer_outdoor.jpg" class="image"><img alt="" src="/web/20160318225010im_/http://rewiki.regengedanken.de/w/images/thumb/Mm_mapviewer_outdoor.jpg/180px-Mm_mapviewer_outdoor.jpg" width="180" height="139" class="thumbimage"/></a>  <div class="thumbcaption"><div class="magnify"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/File:Mm_mapviewer_outdoor.jpg" class="internal" title="Enlarge"><img src="/web/20160318225010im_/http://rewiki.regengedanken.de/w/skins/common/images/magnify-clip.png" width="15" height="11" alt=""/></a></div>ODM map in Might&amp;Magic 6-8 Mapviewer</div></div></div>
<p>Windows application, which displays textured levels(.BLV and .ODM) of Might&amp;Magic 6-8, can be downloaded <a href="https://web.archive.org/web/20160318225010/http://angel-death.newmail.ru/#MM_MapViewer" class="external text" rel="nofollow">here</a>. To use it unpack into game folder and launch mm_mapviewer.exe,
setting in config.ini:
</p>
<pre>
[Video]
Width 	= 800 - resolution
Window  = 1   1 - window mode 0 - fullscreen
Freq 	= 75  display frequency
Bpp	= 32  color depth
zbuf	= 24  zbuffer depth

[Game]
debug = 0 	- 1 - prints some debug info into console.log
maxfps=0        - set maxfps 0=no limit
mapname = maps/d01.blv - map loaded on start
</pre>
<p>keys:
</p>
<pre>
WSAD  - move
SHIFT - +speed
L     - load map
ESC   - quit
P     - toggle portals (only blv maps)

MOUSE1 - select BModel (only ODM maps)
MOUSE2 - select Face

h - hide/show selected bmodel
j - reset hided bmodels
</pre>

<!-- 
NewPP limit report
Preprocessor node count: 190/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key rewiki:pcache:idhash:1397-0!*!0!!en!2!edit=0 and timestamp 20160318114630 -->
<div class="printfooter">
Retrieved from "<a href="https://web.archive.org/web/20160318225010/http://rewiki.regengedanken.de/wiki/.BLV">http://rewiki.regengedanken.de/wiki/.BLV</a>"</div>
		<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Special:Categories" title="Special:Categories">Category</a>: <span dir="ltr"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Category:File_format" title="Category:File format">File format</a></span></div></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				 <li id="ca-nstab-main" class="selected"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/.BLV" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Talk:.BLV" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=.BLV&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=.BLV&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=Special:UserLogin&amp;returnto=.BLV" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/web/20160318225010im_/http://rewiki.regengedanken.de/w/skins/common/images/mediawiki.png);" href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Main_Page" title="Visit the main page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage-description"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-portal"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/REWiki:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/REWiki:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php" id="searchform">
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="searchInput" title="Search REWiki" accesskey="f" type="search" name="search"/>
				<input type="submit" name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists"/>&#160;
				<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text"/>
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Special:WhatLinksHere/.BLV" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Special:RecentChangesLinked/.BLV" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=.BLV&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/web/20160318225010/http://rewiki.regengedanken.de/w/index.php?title=.BLV&amp;oldid=5260" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico">
		<a href="https://web.archive.org/web/20160318225010/http://www.mediawiki.org/"><img src="/web/20160318225010im_/http://rewiki.regengedanken.de/w/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31"/></a>
	</div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 10 November 2011, at 02:18.</li>
		<li id="viewcount">This page has been accessed 13,655 times.</li>
		<li id="privacy"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/REWiki:Privacy_policy" title="REWiki:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/REWiki:About" title="REWiki:About">About REWiki</a></li>
		<li id="disclaimer"><a href="/web/20160318225010/http://rewiki.regengedanken.de/wiki/REWiki:General_disclaimer" title="REWiki:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>

<script src="/web/20160318225010js_/http://rewiki.regengedanken.de/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": ".BLV", "wgTitle": ".BLV", "wgAction": "view", "wgArticleId": 1397, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 5260, "wgCategories": ["File format"], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script><!-- Served in 0.022 secs. --></body></html><!--
     FILE ARCHIVED ON 22:50:10 Mar 18, 2016 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 10:07:29 Apr 11, 2018.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  LoadShardBlock: 149.87 (3)
  esindex: 0.015
  captures_list: 190.762
  CDXLines.iter: 14.097 (3)
  PetaboxLoader3.datanode: 111.722 (4)
  exclusion.robots.fetch: 19.793 (2)
  exclusion.robots: 20.512
  exclusion.robots.policy: 0.33
  RedisCDXSource: 1.881
  PetaboxLoader3.resolve: 241.255 (3)
  load_resource: 255.426
-->